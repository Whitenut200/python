# 데이터 불러오기
import pandas as pd
# 컬림 이름 설정 header=1
# 마지막 행 2개 없애기 skipfooter=2
# 열 개수 설정 usecols='A:C'
sample_1=pd.read_excel('G:/내 드라이브/파이썬/sample_1.xlsx',header=1,skipfooter=2,usecols='A:C')

# 기본 문법
sample_1.describe()
sample_1[['국적코드','입국객수']]
condition=(sample_1['성별']=='남성')&(sample_1['입국객수']>=150000)
sample_1[condition]

conditions=(sample_1['국적코드'].isin(['A01','A18']))
conditions
sample_1[conditions==False]

code_m=pd.read_excel('G:/내 드라이브/파이썬/sample_codemaster.xlsx')
sample_1_code=pd.merge(left=sample_1,right=code_m,how='left',left_on='국적코드',right_on='국적코드')

sample_2=pd.read_excel('G:/내 드라이브/파이썬/sample_2.xlsx',header=1,skipfooter=2,usecols='A:C')
sample_2['기준월일']='2019-12'
sample_2_code=pd.merge(left=sample_2,right=code_m,how='left',left_on='국적코드',right_on='국적코드')

sample=sample_1_code.append(sample_2_code, ignore_index=True)
sample.to_excel('G:/내 드라이브/파이썬/sample.xlsx')
sample_pivot=sample.pivot_table(values='입국객수',index='국적명',columns='기준월일',aggfunc='mean')

# 웹크롤링
from selenium import webdriver
driver=webdriver.Chrome('C:/Windows/chromedriver/chromedriver.exe')

from bs4 import BeautifulSoup
html=driver.page_source
soup=BeautifulSoup(html,'html.parser')

songs=soup.select('table>tbody>tr')
print(len(songs)) # 100
print(songs[0])
song=songs[0] # 1위 곡 가져오기
print(song) 

# 노래 가져오기
title=song.select('a')
len(title) # 6

title=song.select('span>a')
len(title) # 2

title=song.select('div.ellipsis.rank01>span>a')
len(title) # 1

title=song.select('div.ellipsis.rank01>span>a')[0].text

singer=song.select('div.ellipsis.rank02>a')
len(singer) # 1

singer=song.select('div.ellipsis.rank02>a')[0].text

for song in songs:
    title=song.select('div.ellipsis.rank01>span>a')[0].text
    singer=song.select('div.ellipsis.rank02>a')[0].text
    print(title,singer,sep='|')

## ## for song in songs : …

Ditto|NewJeans
OMG|NewJeans
Teddy Bear|STAYC(스테이씨)
Hype boy|NewJeans
파이팅 해야지 (Feat. 이영지)|부석순 (SEVENTEEN)
사건의 지평선|윤하 (YOUNHA)
심(心)|DK(디셈버)
I Don't Think That I Like Her|Charlie Puth
사랑하기 싫어|지아
Attention|NewJeans
VIBE (feat. Jimin of BTS)|태양
ANTIFRAGILE|LE SSERAFIM (르세라핌)
사랑은 늘 도망가|임영웅
After LIKE|IVE (아이브)
나비무덤|포맨 (4MEN)
CHRISTIAN|Zior Park
우리들의 블루스|임영웅
LOVE DIVE|IVE (아이브)
사랑인가 봐|멜로망스
다시 만날 수 있을까|임영웅
Candy|NCT DREAM
건물 사이에 피어난 장미 (Rose Blossom)|H1-KEY (하이키)
Dangerously|Charlie Puth
너의 모든 순간|성시경
London Boy|임영웅
Nxde|(여자)아이들
무지개|임영웅
이제 나만 믿어요|임영웅
Rush Hour (Feat. j-hope of BTS)|Crush
Polaroid|임영웅
Monologue|테이
아버지|임영웅
on the street (with J. Cole)|j-hope
That's Hilarious|Charlie Puth
Cookie|NewJeans
NIGHT DANCER|imase
새삥 (Prod. ZICO) (Feat. 호미들)|지코 (ZICO)
해요 (2022)|#안녕
Sugar Rush Ride|투모로우바이투게더
A bientot|임영웅
Say I Love You|우디 (Woody)
인생찬가|임영웅
Poppy (Korean Ver.)|STAYC(스테이씨)
Nostalgia|우디 (Woody)
Unholy|Sam Smith
Shut Down|BLACKPINK
취중고백|김민석 (멜로망스)
NOT SORRY (Feat. pH-1) (Prod. by Slom)|이영지
손이 참 곱던 그대|임영웅
Dynamite|방탄소년단
STAY|The Kid LAROI
너와 함께|김민석 (멜로망스)
사랑해 진짜|임영웅
내가 아니라도|주호
TOMBOY|(여자)아이들
연애편지|임영웅
Pink Venom|BLACKPINK
봄날|방탄소년단
FEARLESS|LE SSERAFIM (르세라핌)
Dreamers [Music from the FIFA World Cup Qatar 2022 Official Soundtrack] (Feat. FIFA Sound)|정국
그라데이션|10CM
사랑이라 믿었던 것들은 (Feat. 이수현)|BIG Naughty (서동현)
오르트구름|윤하 (YOUNHA)
그때 그 순간 그대로 (그그그)|WSG워너비 (가야G)
다정히 내 이름을 부르면|경서예지
혼자가 아닌 나|정효빈
마지막 사랑|신예영
보금자리|임영웅
네가 보고 싶은 건 자연스러운 거겠지|신예영
정이라고 하자 (Feat. 10CM)|BIG Naughty (서동현)
That That (prod. & feat. SUGA of BTS)|싸이 (PSY)
그대를 알고|송하예
모든 날, 모든 순간 (Every day, Every Moment)|폴킴
잘가요|주호
Butter|방탄소년단
ELEVEN|IVE (아이브)
그댄 행복에 살텐데 (2022)|최유리
나의 X에게|경서
딱 10CM만|10CM
이젠 안녕|투모로우바이투게더
자격지심 (Feat. ZICO)|BE'O (비오)
Off My Face|Justin Bieber
Left and Right (Feat. Jung Kook of BTS)|Charlie Puth
Permission to Dance|방탄소년단
LOVE me|BE'O (비오)
떠나보낼 준비해 둘걸 그랬어|임한별
마이웨이 (MY WAY) (Prod. R.Tee)|저스디스 (JUSTHIS)
Expectations|Anne-Marie
밤하늘의 별을(2020)|경서
봄여름가을겨울 (Still Life)|BIGBANG (빅뱅)
보고싶었어|WSG워너비(4FIRE)
내 기쁨은 너가 벤틀리를 끄는 거야|김승민
혼자서 걸어요 (Prod. by 나얼)|태연 (TAEYEON)
WHEN I MOVE|카라
니 번호가 뜨는 일|이예준
첫사랑|백아
그중에 그대를 만나|김호중
그대라는 사치|임창정
친구로 지내다 보면 (Feat. 김민석 of 멜로망스)|BIG Naughty (서동현)
당신을 만나|김호중

# 멜론,지니,버즈 모두 합치기
total_song=['G:/내 드라이브/파이썬/melon.xlsx','G:/내 드라이브/파이썬/bugs.xlsx','G:/내 드라이브/파이썬/genie.xlsx']
appended_data=pd.DataFrame()
for name in total_song:
    pd_data=pd.read_excel(name)
    appended_data=appended_data.append(pd_data)

appended_data.to_excel('G:/내 드라이브/파이썬/total.xlsx',index=False)

# 유튜브 데이터 크롤링 
from selenium import webdriver
from bs4 import BeautifulSoup
import time
import pandas as pd

browser=webdriver.Chrome('C:/Windows/chromedriver/chromedriver.exe')
url="https://youtube-rank.com/board/bbs/board.php?bo_table=youtube"
browser.get(url)

html=browser.page_source
soup=BeautifulSoup(html,'html.parser')

